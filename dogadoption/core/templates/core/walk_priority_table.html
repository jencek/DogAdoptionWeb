{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Dog Walk Priority List</h2>

  <form method="get" class="form-inline mb-3">
    <div class="form-group mr-3">
      <label for="walker_capability">Walker capability:</label>
      <select name="walker_capability" id="walker_capability" class="form-control ml-2">
        <option value="">All</option>
        <option value="Beginner <10" {% if walker_capability == "Beginner <10" %}selected{% endif %}>Beginner &lt;10</option>
        <option value="General" {% if walker_capability == "General" %}selected{% endif %}>General</option>
        <option value="Experienced" {% if walker_capability == "Experienced" %}selected{% endif %}>Experienced</option>
        <option value="KH" {% if walker_capability == "KH" %}selected{% endif %}>KH</option>
        <option value="Dog Buddy" {% if walker_capability == "Dog Buddy" %}selected{% endif %}>Dog Buddy</option>
      </select>
    </div>

    <div class="form-group mr-3">
      <label for="order_by">Order by:</label>
      <select name="order_by" id="order_by" class="form-control ml-2">
        <option value="days" {% if order_by == "days" %}selected{% endif %}>Days Since Last Walk</option>
        <option value="week" {% if order_by == "week" %}selected{% endif %}>Walks This Week</option>
        <option value="last2weeks" {% if order_by == "last2weeks" %}selected{% endif %}>Walks in Last 2 Completed Weeks</option>
      </select>
    </div>

    <div class="form-group mr-3">
      <label for="limit">Show top:</label>
      <select name="limit" id="limit" class="form-control ml-2">
        {% for n in limits %}
          <option value="{{ n }}" {% if limit == n %}selected{% endif %}>{{ n }}</option>
        {% endfor %}
      </select>
    </div>

    <button type="submit" class="btn btn-primary">Apply</button>
  </form>

  <table class="table table-striped table-bordered">
    <thead class="thead-dark">
      <tr>
        <th>Dog</th>
        <th>Last Walk</th>
        <th>Days Since Last Walk</th>
        <th>Walks This Week</th>
        <th>Walks Last 2 Weeks</th>
        <th>Priority Value</th>
      </tr>
    </thead>
    <tbody>
      {% for item in dogs %}
      <tr class="{{ item.priority_class }}">
        <td><a href="{{ item.dog.url }}" target="_blank">{{ item.dog.name }}</a></td>
        <td>{% if item.last_walk %}{{ item.last_walk|date:"Y-m-d" }}{% else %}<em>Never</em>{% endif %}</td>
        <td>{{ item.days_since_last }}</td>
        <td>{{ item.walks_this_week }}</td>
        <td>{{ item.walks_last_2_weeks }}</td>
        <td>{{ item.priority_score }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="text-center">No dogs found.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <p class="mt-3"><small>
    <strong>Legend:</strong>
    <span class="badge bg-danger">High</span>
    <span class="badge bg-warning text-dark">Medium</span>
    <span class="badge bg-info text-dark">Moderate</span>
    <span class="badge bg-success">Low</span>
  </small></p>
</div>
{% endblock %}
